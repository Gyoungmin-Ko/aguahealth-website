# 퇴방 모듈: 제품 / 상품 구분 설계

퇴장방지의약품 지정 및 원가보전 모듈은 **제품(국내제조)** 과 **상품(수입의약품)** 을 구분해 입력·계산합니다.

---

## 1. 구분 정의

| 구분 | 설명 | 근거 서식·원가산정 |
|------|------|---------------------|
| **제품** | 국내에서 제조하는 의약품 | [별지 4] 제품별 상세내역서, [별지 6] 원가계산서, 최종보고서 **표 59** (p.113) |
| **상품** | 수입의약품 | [별지 5] 상품(수입의약품)별 상세내역서, 최종보고서 **표 60** (p.115) |

---

## 2. 웹 동작

- **입력**: 첫 항목에서 「제품 (국내제조)」 또는 「상품 (수입의약품)」 선택 시, 해당 유형에 맞는 입력 필드만 표시.
- **제품**: 1규격단위당 원료비·재료비·노무비·제조경비·판관비·영업외·적정이윤률 입력 → **원가계산 수식**으로 조정신청금액 산출.
- **상품**: 현재는 입력만 받고, 「상품(수입의약품) 원가산정은 준비 중」 안내 반환. 추후 표 60·[별지 5] 반영 시 계산 기능 추가.

---

## 3. 입력 필드 매핑

### 3.1 공통 (제품·상품 모두)
- 구분(제품/상품)
- 제품/상품명, 업소명, 약가코드, 규격단위
- 지정 희망 시점
- 원가자료(첨부), 추가 메모

### 3.2 제품(국내제조) 전용
- 연간 총생산량(규격단위)
- 1단위당 원료비·재료비·노무비·제조경비(원)
- 1단위당 판매 및 일반관리비·영업외 손익(원)
- 적정이윤률(%)

### 3.3 상품(수입의약품) 전용
- 1단위당 매입원가(원)
- 1단위당 판매 및 일반관리비(원)
- 적정이윤률(%)
- (추후 표 60·별지 5에 맞춰 항목 추가)

---

## 4. 원가계산

- **제품**: `docs/퇴방_원가계산_수식_정리.md` 기준.  
  제조원가 소계 + 판관비 + 영업외 → 적정이윤 가산 → 부가세 10%·유통거래폭 5.15% 적용 → **조정신청금액**.
- **상품**: 추후 표 60 및 [별지 5] 구조에 맞춰 동일하게 “입력 → 조정신청금액” 산출 구현 예정.

---

## 5. 파일 위치

| 역할 | 경로 |
|------|------|
| 입력 정의(제품/상품 필드) | `src/data/aiModules.js` (drug-withdrawal-prevention) |
| 입력 폼·결과 표시 | `src/pages/ai/AIModule.jsx` (showWhen, 조정신청금액 카드) |
| 제품 원가계산·상품 안내 | `functions/api/ai-module/[moduleId].js` |

이 상태로 우선 제품 원가계산을 사용하고, 상품은 보완 시 반영하면 됩니다.
